#include<stdio.h>
#include<conio.h>

void main(){
	int n,i,tempa=0,tempb=0,s=0,t=0,bt=0,a,b,j,g,zc=0,tmq=0,time=0;
	int tq[840],tbt[840],tat[840];
	int sq[840],sbt[840],sat[840];
	char ts;
	printf("__________________Query Management System_________________\n\n");
printf("Enter Number of Queries : ");
scanf("%d",&n);
printf("Please enter the details -\n");
	
for(i=0;i<n;i++){
	printf("Enter T/t if you are a teacher or Enter S/s if you are a student :");
	scanf(" %c", &ts);
	printf("Enter Burst Time :");
	scanf("%d",&tempb);	
//	printf("%d",&tempb);
	bt=bt+tempb;
	printf("Enter Arival Time :");
	scanf("%d",&tempa);	
	if(ts=='t'||ts=='T'&&bt<=840)
	{
		tbt[t]=tempb;
		tat[t]=tempa;
		t=t+1;
		tq[t]=t+1;
		
		}
		else if(ts=='s'||ts=='S'&&bt<=840)
	{
		sbt[s]=tempb;
		sat[s]=tempa;
		s=s+1;
		sq[s]=s+1;
		
	}
	}
	printf("Enter Time Quantum :");
	scanf("%d",&tmq);	
	
	
	

 
	
        for (i = 0; i < s; ++i) 
        {
 
            for (j = i + 1; j < s; ++j)
            {
 
                if (sat[i] > sat[j]) 
                {
 
                    a =  sat[i];
                    sat[i] = sat[j];
                    sat[j] = a;
                    b =  sbt[i];
                    sbt[i] = sbt[j];
                    sbt[j] = b;
                    a =  sq[i];
                    sq[i] = sq[j];
                    sq[j] = a;
 
                }
 
            }
 
        }
        for (i = 0; i < t; ++i) 
        {
 
            for (j = i + 1; j < t; ++j)
            {
 
                if (tat[i] > tat[j]) 
                {
 
                    a =  tat[i];
                    tat[i] = tat[j];
                    tat[j] = a;
                    b =  tbt[i];
                    tbt[i] = tbt[j];
                    tbt[j] = b;
                    b =  tq[i];
                    tq[i] = tq[j];
                    tq[j] = b;
 
                }
 
            }
 
        }
       for(i=0;i<t;i++){
       	printf("\n%d,%d\n",tat[i],tbt[i]);
		}		
		        for(i=0;i<s;i++){
      	printf("\n--%d,%d\n",sat[i],sbt[i]);
	}
	if(t>s){
		g=t;
		
	}
	else if(s>t){
		g=s;
	}
	else{
		g=t;
	}
	i=0;
	j=0;
 while(zc!=t+s){
 	while(i!=s||j!=t){
 		if(tat[i]<=time){
 			time=time+1;
		 if(i>t){
		 }
		 else if(tbt[i]==0){
		 	zc=zc+1;
		 }
		 else{
		 	if(tbt[i]==tmq||tbt[i]<tmq){
		 		tbt[i]=0;
		 		time=time+tbt[i];
		 		
			 }
			 else{
			 	tbt[i]=tbt[i]-tmq;
			 }
			 
	}
	i=i+1;
		 	
		 }
		  		if(sat[i]<=time){
		  			time=time+1;
		 if(j>s){
		 }
		 else if(sbt[j]==0){
		 	zc=zc+1;
		 }
		 else{
		 	if(sbt[j]==tmq||sbt[j]<tmq){
		 		sbt[i]=0;
		 		time=time+sbt[i];
		 		
			 }
			 else{
			 	sbt[j]=sbt[j]-tmq;
			 }
			 
	}
	j=j+1;
		 	
		 }
	 }
 	
 }
 


}
